---
title: "Data 698 - Final Project"
subtitle: "Predicting Winning New York Mega Millions Lottery Numbers"
author: "Richard Zheng, Stephen Haslett"
date: "2/13/2022"
output:
 html_document:
    toc: true
    toc_float: true
    theme: flatly
    highlight: tango
---

```{r documentSetup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
```

## Abstract

The goal of this study is to establish if it is possible to strategically play the lottery in order to increase both prize money, and the chances of winning. To determine this, we focused on the [Mega Millions](https://nylottery.ny.gov/draw-game/?game=megamillions) lottery game. Mega Millions is a United States based lottery that is played twice a week, and is available in 45 states plus the District of Columbia and the U.S. Virgin Islands. To participate in the game, players must select 5 numbers from 1 to 70, and 1 number from 1 to 25 for the Mega Ball. If the player matches all 5 numbers plus the Mega Ball, then they win the jackpot. [Lower prize tiers](https://nylottery.ny.gov/draw-game/?game=megamillions#odds_prizes) are available for matches that fall short of the jackpot requirement.      

Abstract: use 250 words or less to summarize your problem, methodology, and major outcomes.

**Keywords**: _probability_, _lottery strategy_, _gambler's fallacy_, _hot hand fallacy_.

## Introduction

The famous American writter Ambrose Bierce once defined a lottery as "_A tax on people who are bad at math_" (_The Unabridged Devil's Dictionary_). According to the United States Census Bureau's [2020 Annual Survey of State Government Finances](https://www.census.gov/data/tables/2020/econ/state/historical-tables.html), Americans spent more than $80 billion on lottery tickets in 2020 alone. Based on these statistics, it is clear that many Americans, despite the incredibly thin odds of winning the jackpot (_1 in 302,575,350 for the Mega Millions jackpot_), are willing to shun Bierce's advice and part with a significant amount of money for the chance of lifelong financial security.

The outrageously slim chances of winning have led to an array of different approaches to playing the lottery in the hope of beating the odds. These range from strategies based on mysticism, such as playing numbers based on [numerology](https://www.mercurynews.com/2019/03/20/want-to-win-tonights-550m-powerball-take-a-deeper-look-at-the-numbers/), to those based on statistical probability, such as playing numbers that have frequently shown up in winning number sets and are thus believed to more likely show up in future drawings.

While there may be an unlikely chance that mystical strategies can assist in increasing the odds of winning the lottery, such appraoches are unmeasurable and as such, this study will not be concerned with mystical strategies. Instead, we will focus on strategies that are based on statistical probability, and are thus more measurable.

In order to assess if these strategies can better one's odds of winning, We will analyze the past 20 years of winning numbers from the [Mega Millions](https://nylottery.ny.gov/draw-game/?game=megamillions) lottery to answer the following questions:

- Is it possible to predict future winning lottery numbers based on previous results?

- Can a pattern be identified regarding which winning numbers are drawn most often per game over time?

- Can playing these numbers increase our chances of winning, and how does this strategy relate to the [hot hand fallacy](https://en.wikipedia.org/wiki/Hot_hand)?

- Conversely, can avoiding these numbers increase the odds of winning, and how does this strategy relate to the [gambler's fallacy](https://en.wikipedia.org/wiki/Gambler%27s_fallacy)?

- In terms of winning, is it better to play the same numbers, or pick random numbers every game?

- Out of all the strategies under investigation, which strategy gives us the best return on investment (if any)?

We will compare 4 different game strategies in this study to determine if one or more strategies results in a greater amount of wins. The strategies that we will investigate are as follows:

1. **Consistent Numbers Strategy**  
_Playing the same numbers every game_. 

2. **Random Numbers Strategy**  
_Playing randomly selected numbers every game_. 

3. **Most Frequent Numbers Strategy**  
_This strategy involves playing the numbers that have most frequently occurred in past winning number sets every game_.

4. **Least Frequent Numbers Strategy**  
_This strategy involves playing the numbers that have least frequently occurred in past winning number sets every game_.


### The Mega Millions Lottery Game

Mega Millions is a US multi-state lottery game that is drawn twice a week on Tuesdays and Fridays.
To participate in the game, players purchase one or more lottery tickets at a cost of $2 per ticket.
Players must pick **5** _unique numbers_ from **1** to **70**, and **1** number from **1** to **25** for the _Mega Ball_.
Optionally, players can opt for randomly selected numbers at the time of ticket purchase.

#### Game Rules

Lottery numbers are drawn randomly **twice** a week on _Tuesdays_ and _Fridays_ at 11PM (EST). 
50% of lottery ticket sales is allocated as prize money (_75% of which is__used for the jackpot payout_). 
If all of the numbers selected by the player (_including the Mega Ball_) are drawn, then the player wins the jackpot. 
If multiple players win the jackpot, then the jackpot is divided equally among the winning players. 
If no one wins the jackpot for a particular drawing, then the jackpot amount rolls over to the next drawing. 
The remaining 25% of the prize money is then allocated to lower tiered prizes.

**Mega Millions Prize Tiers**

```{r, prizeTiers, echo=FALSE, message=FALSE, warning=FALSE}
tableData <- data.frame(c("Jackpot", "Second Prize", "Third Prize", "Fourth Prize", "Fifth Prize",  "Sixth Prize", "Seventh Prize", "Eighth Prize", "Ninth Prize"),
                        c("5 matching numbers with the Mega Ball", "5 matching numbers", "4 matching numbers with the Mega Ball",
                          "4 matching numbers", "3 matching numbers with the Mega Ball", "3 matching numbers", "2 matching numbers with the Mega Ball",
                          "1 matching number with the Mega Ball", "No matching numbers with the Mega Ball"),
                        c("75% of the total prize money", "$1,000,000", "$10,000", "$500", "$200", "$10", "$10", "$4", "$2"),
                        c("1 in 302,575,350", "1 in 12,607,306", "1 in 931,001", "1 in 38,792", "1 in 14,547", "1 in 606", "1 in 693", "1 in 89", "1 in 37"))
                          
colnames(tableData) <- c("Prize", "Winning Criterion", "Payout", "Odds of Winning")

kable(tableData, caption = 'Prize Tiers and Payouts') %>%
      kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
      scroll_box(width = '100%')
```

\ 

Additionally, Players can pay an extra dollar to purchase a multiplier number. 
Multiplier numbers range from **2** to **5**. 

If a player picks a winning multiplier number and also winning lottery numbers, 
then the payout for the winning lottery numbers will be multiplied by the winning multiplier number. 


## Data Source

The data that we utilized for this project was supplied by [NY Open Data](https://data.ny.gov/),
and contains biweekly winning Mega Millions lottery numbers from 2002, through the current week. 
The dataset is in CSV format and can be accessed at the following location:

[Lottery Mega Millions Winning Numbers: Beginning 2002](https://data.ny.gov/Government-Finance/Lottery-Mega-Millions-Winning-Numbers-Beginning-20/5xaw-6ayf/data). As of writing, the set consists of 2058 observations broken into 4 columns:

- **Draw Date**: _The date on which the lottery draw took place_.
- **Winning Numbers**: _The winning numbers for the given lottery draw_.
- **Mega Ball**: _The winning Mega Ball for the draw_.
- **Multiplier**: _The winning multiplier number for the draw_.



## Literature Review

In a 2012 study on predicting lottery numbers (_Galbo-JÃ¸rgensen, Claus B., Suetens, Sigrid., Tyran, Jean-Robert. 2012_), it was observed that many lottery players fall prey to the [gambler's fallacy](https://en.wikipedia.org/wiki/Gambler%27s_fallacy) when picking lottery numbers. According to the gambler's fallacy, players tend to avoid picking numbers that were recently included in the winning numbers set under the believe that if an event occurred recently, it is less likely to occur again. Contrary to this, other players pick numbers in accordance with the [hot hand fallacy](https://en.wikipedia.org/wiki/Hot_hand) which is the believe in a continuation of a trend, i.e. if specific numbers were recently included in the winning numbers set, then they are more likely to occur in future drawings [(1)](#references).

Otekunrin and Folorunso (_2021_) observed that some players will select lottery numbers based on personally significant numbers such as birthdays, house numbers, anniversary dates etc., whilst others heuristically choose numbers based on their frequency of occurrence in previous drawings. When a heuristic approach is applied to lottery number selection, it was observed that players tend to believe that well-spread out numbers are better than distinctive ones even though both have the same probability of occurrence [(2)](#references).

While the aforementioned studies are concerned with the psychology behind picking lottery numbers, this study focuses on whether or not these selection techniques increase one's chances of selecting winning lottery numbers. We are more concerned with proving these techniques to be either effective or ineffective through the application of mathematics, than with why people believe them to be so.

This approach is in the same vein as Renato Gianella's approach to this subject. Gianella (_2014_) observed that winning lottery number combinations follow a predictable pattern. By applying probability theory to lottery drawings, Gianella established that the results of a lottery draw follow the same behavior pattern as predicted by the Law of Large Numbers - _When an event is repeated many times, the average of the results from all events should be close to the expected result_ [(3)](#references).

Gianella's method is based on groups of number combinations built from previous lottery results. When tested, his method demonstrated that the probability that a given number combination occurs is not the same for all groups, and that certain groups display a higher probability of winning.

This study does not assume that Gianella's method is effective, rather it sets out to adopt similar logical strategies to prove that Gianella's method, and other strategies are either effective or ineffective in increasing one's chances of winning the lottery.





## Methodology
In order to evaluate
discuss the key aspects of your model/problem. If you work on real data, explain how you verified your model. If you work on theoretical aspects of data science advancement, explain your method with details (you can put the theory and proof in the appendix if you see fit).

- Lottery is rule based and follows logic and thus it can be simulated.

- Talk about how we are comparing models - comparing using T test.

- How we are verifying our models - with the T test. We can do it on our data due to the central limit theorem (the sample mean comes from a normal distribution with standard deviation = to standard error - given that the sample size is large enough). Doesn't matter what distribution your sample looks like, because the resampled means will approximate a normal distribution.  

## Results

All my code will be pointing toward how we came up with hot hand fallacy numbers (charts, tables, etc. to show this). 
describe what you did (validation, experimental design, the study of the theories, etc.), and what you found out (statistical analysis, comparison of various approaches, system performance improvement, optimization, new algorithm development, etc.).

## Summary
conclude your findings, suggest areas for future work.



Most of these papers agree that trying to predict next weeks lottery numbers is absurd. Despite popular beliefs and fallacies, there is no reliable way to predict the lottery. If the odds of winning the lottery are so small, someone may ask: "how come people win all the time?".

Although the odds of winning the Mega Millions are about one in 300 million, people win all the time because millions of people play weekly.
While we agree with the overall consensus, that the lottery is unpredictable, we still want to see if there are any strategies to even get a slight edge when playing.



## Approach

It is impossible to evaluate our predictions against future winning lottery numbers so we will split the dataset into separate training, and test sets. 
The training set will be used to identify winning number patterns, and the test set will be used to establish if our predictions influence the winning numbers.

### Lottery Number Selection Strategies

There are several lottery number selection strategies that we need to simulate:\
      
**Same Number Selection**\
This is the simplest selection strategy. We will pick the 6 numbers required by the game (_5 unique numbers, and 1 Mega Ball number_) within the required range
(_1 to 70_ for unique numbers, and _1 to 25_ for the Mega Ball), and a **Multiplier** number within the required range of _2 to 5_.
       
**Random Number Selection**\
To simulate picking random lottery numbers, we will write a number generator in R that randomly generates the required 6 numbers and optional Multiplier number.

**Most Frequent Winning Numbers Selection**\
To generate number selections based on the most frequent winning numbers, we will write an R program that mines the training data and counts how often specific winning numbers occur. We will then rank these numbers and based on how high specific numbers rank, we will include them in our selection.

### Selection Strategy Evaluation

In order to evaluate which selection strategy (_if any_) is most effective, we will compare the strategy selections against the test data to evaluate which strategy results in winning selections most often. This will entail writing an R program that runs each individual strategy against the test data. The program will count the amount of times each strategy results in winning results, and rank them accordingly. Whichever strategy ranks highest, will tell us which strategy is most effective at predicting winning lottery results.


## References  {#references}

1. **_Galbo-JÃ¸rgensen, Claus B., Suetens, Sigrid., Tyran, Jean-Robert. (2012)_** \
[Predicting Lotto Numbers - A natural experiment on the gamblerâs fallacy and the hot hand fallacy](https://www.parisschoolofeconomics.eu/IMG/pdf/suetens_paper.pdf)
    
2. **_Oluwaseun A. Otekunrin., Adesola G. Folorunso., Kehinde O. Alawode. (2021)_** \
[Number Preferences In Selected Nigerian Lottery Games](http://journal.sjdm.org/20/201204a/jdm201204a.pdf)

3. **_Gianella Renato. (2014)_** \
[The Geometry Of Chance:Lotto Numbers Follow A Predicted Pattern](http://jaguar.fcav.unesp.br/RME/fasciculos/v31/v31_n4/A7_RGiarelli.pdf)


## Appendix 

https://github.com/stephen-haslett/Data698ResearchProject

Add links to individual files along with a summary explaining each file.




