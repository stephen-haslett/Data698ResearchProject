---
title: "Data 698 - Final Project"
subtitle: "Predicting Winning New York Mega Millions Lottery Numbers"
author: "Richard Zheng, Stephen Haslett"
date: "2/13/2022"
output:
 html_document:
    toc: true
    toc_float: true
    theme: flatly
    highlight: tango
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
```

![](./images/MegaMillionsLogo.png)

## Abstract

The goal of this study is to establish if it is possible to strategically play the lottery in order to increase both prize money, and the chances of winning.

Abstract: use 250 words or less to summarize your problem, methodology, and major outcomes.

**Keywords**: _probability_, _lottery strategy_, _gambler's fallacy_, _hot hand fallacy_.


## Introduction

The purpose of this investigation is to establish whether or not it is possible to predict future winning lottery numbers based on past winning results.
To do this, we will analyze the past 20 years of winning numbers for the [Mega Millions](https://nylottery.ny.gov/draw-game/?game=megamillions) lottery to answer the following questions:

- Is it possible to predict future winning lottery numbers based on previous results?

- Can a pattern be identified regarding which winning numbers are drawn most often per game over time?

- Does using these numbers increase our chances of winning?

- In terms of winning, is it better to play the same numbers, or pick different numbers every game?

- What strategies can be applied to ensure our chances of winning are increased (if any)?

- How do winning numbers correlate to payout amounts?

- What statistical theories are applicable to our goal, and which theories can benefit us (if any):

    - [Law of Large Numbers](https://en.wikipedia.org/wiki/Law_of_large_numbers)
    - [Monty Hall Problem](https://en.wikipedia.org/wiki/Monty_Hall_problem)
    - [Gambler's Fallacy](https://en.wikipedia.org/wiki/Gambler%27s_fallacy)
    - [Hot Hand Fallacy](https://www.investopedia.com/terms/h/hot-hand.asp#:~:text=The%20hot%20hand%20fallacy%20is,rolled%20it%20in%20the%20past)

Similar to previous studies, we want to understand whether or not it is possible to obtain an edge when playing the lottery. With the Data that we have gathered
(_From the nylottery and megamillions websites_), we will identify data trends and use simulations to answer the aforementioned questions. 
In addition to testing various "winning strategies", we also want to explore lottery payout amounts, as jackpot numbers change, and prize money expections.

### Mega Millions Lottery Game

Mega Millions is a US multi-state lottery game that is drawn twice a week on Tuesdays and Fridays.
To participate in the game, players purchase one or more lottery tickets at a cost of $2 per ticket.
Players must pick **5** _unique numbers_ from **1** to **70**, and **1** number from **1** to **25** for the _Mega Ball_.
Optionally, players can opt for randomly selected numbers at the time of ticket purchase.

### Game Rules

Lottery numbers are drawn randomly **twice** a week on _Tuesdays_ and _Fridays_ at 11PM (EST). 
50% of lottery ticket sales is allocated as prize money (_75% of which is__used for the jackpot payout_). 
If all of the numbers selected by the player (_including the Mega Ball_) are drawn, then the player wins the jackpot. 
If multiple players win the jackpot, then the jackpot is divided equally among the winning players. 
If no one wins the jackpot for a particular drawing, then the jackpot amount rolls over to the next drawing. 
The remaining 25% of the prize money is then allocated to lower tiered prizes.

**Mega Millions Prize Tiers**

```{r, prizeTiers, echo=FALSE, message=FALSE, warning=FALSE}
tableData <- data.frame(c("Jackpot", "Second Prize", "Third Prize", "Fourth Prize", "Fifth Prize",  "Sixth Prize", "Seventh Prize", "Eighth Prize", "Ninth Prize"),
                        c("5 matching numbers with the Mega Ball", "5 matching numbers", "4 matching numbers with the Mega Ball",
                          "4 matching numbers", "3 matching numbers with the Mega Ball", "3 matching numbers", "2 matching numbers with the Mega Ball",
                          "1 matching number with the Mega Ball", "No matching numbers with the Mega Ball"),
                        c("75% of the total prize money", "$1,000,000", "$10,000", "$500", "$200", "$10", "$10", "$4", "$2"),
                        c("1 in 302,575,350", "1 in 12,607,306", "1 in 931,001", "1 in 38,792", "1 in 14,547", "1 in 606", "1 in 693", "1 in 89", "1 in 37"))
                          
colnames(tableData) <- c("Prize", "Winning Criterion", "Payout", "Odds of Winning")

kable(tableData, caption = 'Prize Tiers and Payouts') %>%
      kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
      scroll_box(width = '100%')
```

\ 

Additionally, Players can pay an extra dollar to purchase a multiplier number. 
Multiplier numbers range from **2** to **5**. 

If a player picks a winning multiplier number and also winning lottery numbers, 
then the payout for the winning lottery numbers will be multiplied by the winning multiplier number. 

## Literature Review

In a 2012 study on predicting lottery numbers (_Galbo-Jørgensen, Claus B., Suetens, Sigrid., Tyran, Jean-Robert. 2012_), it was observed that many lottery players fall prey to the _gambler's fallacy_ when picking lottery numbers. According to the gambler's fallacy, players tend to avoid picking numbers that were recently included in the winning numbers set under the believe that if an event occured recently, it is less likely to occur again. Contrary to this, other players pick numbers in accordance with the _hot hand fallacy_ which is the believe in a continuation of a trend, i.e. if specific numbers were recently included in the winning numbers set, then they are more likely to occur in future drawings [(1)](#references). While this study is more concerned with the psychology behind picking lottery numbers, the current study focuses on whether or not these lottery number selection techniques increase one's chances of selecting winning lottery numbers.     


suggested that while it is not possible to increase your chances of winning the lottery, it is possible to maximize your winnings. These studies show that previous results have no impact on future results (_gambler's fallacy_) and numbers that are frequently chosen are due to mere coincidence (_hot hand fallacy_). They go further to suggest that following these gambling ideologies could infact be detrimental as picking popular numbers increases the probability of having to split winnings with others due to the [Parimutuel](https://en.wikipedia.org/wiki/Parimutuel_betting) nature of lottery games [(1)](#references).


In a study focusing on lottery number preferences, it was found that most players have a preference for small numbers (_especially 1 and 9_). Numbers with repeating digits, excluding numbers containing 7 and multiples of 7 (_except for 7 and 77_), are also preferred. The same study also found that players often chose numbers that are spread out and thus appear to be random [(2)](#references). In an additional study, numbers that appear to be random, and combinations with greater variance, were found to be more attractive [(3)](#references).


The consensus among all of these studies is that all individual combinations are equally likely. Despite this, one could potentially increase their odds of winning by picking numbers in specific "behavior patterns" as these patterns obey different probabilities (Gianella). This study compared theoretical and observed probabilities of winning combinations and found that there were certain patterns that appeared more often than other




discuss how other researchers have addressed similar problems, what their achievements are, and what the advantage and drawbacks of each reviewed approach are.  Explain how your investigation is similar or different from the state-of-the-art. Please do not discuss paper one at a time, instead, identify key characteristics of your topic, and discuss them as a whole. Please cite the relevant papers where appropriate. 

## Methodology
discuss the key aspects of your model/problem. If you work on real data, explain how you verified your model. If you work on theoretical aspects of data science advancement, explain your method with details (you can put the theory and proof in the appendix if you see fit).

## Results
describe what you did (validation, experimental design, the study of the theories, etc.), and what you found out (statistical analysis, comparison of various approaches, system performance improvement, optimization, new algorithm development, etc.).

## Summary
conclude your findings, suggest areas for future work.

## Appendices
(put your detailed code here.)


### Relevant Academic Papers and Articles

- [Predicting Lotto Numbers](https://www.parisschoolofeconomics.eu/IMG/pdf/suetens_paper.pdf)

- [Math Explains Likely Long Shots, Miracles and Winning the Lottery](https://www.scientificamerican.com/article/math-explains-likely-long-shots-miracles-and-winning-the-lottery/#:~:text=One%20of%20the%20key%20strands,may%20be%20at%20each%20opportunity.)

- [The Lottery: Is It Ever Worth Playing?](https://www.investopedia.com/managing-wealth/worth-playing-lottery/)

- [Basic Probability Theory and Statistics](https://towardsdatascience.com/basic-probability-theory-and-statistics-3105ab637213)

Most of these papers agree that trying to predict next weeks lottery numbers is absurd. Despite popular beliefs and fallacies, there is no reliable way to predict the lottery. If the odds of winning the lottery are so small, someone may ask: "how come people win all the time?".

Although the odds of winning the Mega Millions are about one in 300 million, people win all the time because millions of people play weekly.
While we agree with the overall consensus, that the lottery is unpredictable, we still want to see if there are any strategies to even get a slight edge when playing.

## Data Source

The main dataset that will be used for this project can be found on the [NY Open Data](https://data.ny.gov/) website,
and contains biweekly winning Mega Millions lottery numbers from 2002, through the current week. 
The dataset is in CSV format and can be accessed here:

[Lottery Mega Millions Winning Numbers: Beginning 2002](https://data.ny.gov/Government-Finance/Lottery-Mega-Millions-Winning-Numbers-Beginning-20/5xaw-6ayf/data). 

**Winning history**: https://www.megamillions.com/jackpot-history

**Drawing history**: https://www.megamillions.com/Winning-Numbers/Previous-Drawings.aspx

As of writing, the set consists of 2058 observations broken into 4 columns:

- **Draw Date**: _The date on which the lottery draw took place_.
- **Winning Numbers**: _The winning numbers for the given lottery draw_.
- **Mega Ball**: _The winning Mega Ball for the draw_.
- **Multiplier**: _The winning multiplier number for the draw_.

## Approach

It is impossible to evaluate our predictions against future winning lottery numbers so we will split the dataset into separate training, and test sets. 
The training set will be used to identify winning number patterns, and the test set will be used to establish if our predictions influence the winning numbers.

### Lottery Number Selection Strategies

There are several lottery number selection strategies that we need to simulate:\
      
**Same Number Selection**\
This is the simplist selection strategy. We will pick the 6 numbers required by the game (_5 unique numbers, and 1 Mega Ball number_) within the required range
(_1 to 70_ for unique numbers, and _1 to 25_ for the Mega Ball), and a **Multiplier** number within the required range of _2 to 5_.
       
**Random Number Selection**\
To simulate picking random lottery numbers, we will write a number generator in R that randomly generates the required 6 numbers and optional Multiplier number.

**Most Frequent Winning Numbers Selection**\
To generate number selections based on the most frequent winning numbers, we will write an R program that mines the training data and counts how often specific winning numbers occur. We will then rank these numbers and based on how high specific numbers rank, we will include them in our selection.

### Selection Strategy Evaluation

In order to evaluate which selection strategy (_if any_) is most effective, we will compare the strategy selections against the test data to evaluate which strategy results in winning selections most often. This will entail writing an R program that runs each individual strategy against the test data. The program will count the amount of times each strategy results in winning results, and rank them accordingly. Whichever strategy ranks highest, will tell us which strategy is most effective at predicting winning lottery results.



## References  {#references}

1. **_Galbo-Jørgensen, Claus B., Suetens, Sigrid., Tyran, Jean-Robert. (2012)_**. [Predicting Lotto Numbers - A natural experiment on
the gambler’s fallacy and the hot hand fallacy](https://www.parisschoolofeconomics.eu/IMG/pdf/suetens_paper.pdf).
    
2. **_Oluwaseun A. Otekunrin., Adesola G. Folorunso., Kehinde O. Alawode. (2021)_**. [Number Preferences In Selected Nigerian Lottery Games](http://journal.sjdm.org/20/201204a/jdm201204a.pdf).

3. **_Kachurka Raman, Krawczyk Michal. (2020)_**. [Lottery "Strategies": Monetizing Players' Behavioral Biases](https://www.wne.uw.edu.pl/application/files/1616/3609/7214/WNE_WP335.pdf).





